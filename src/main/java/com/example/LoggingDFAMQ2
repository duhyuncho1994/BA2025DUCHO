package com.example;

import de.learnlib.query.DefaultQuery;
import de.learnlib.query.Query;
import de.learnlib.oracle.MembershipOracle.DFAMembershipOracle;

import java.util.Collection;
import java.util.List;
import java.util.Map;




public class LoggingDFAMembershipOracle implements DFAMembershipOracle<Character> {
    private final DFAMembershipOracle<Character> delegate;
    private final Map<List<Character>, Boolean> log;

    public LoggingDFAMembershipOracle(DFAMembershipOracle<Character> delegate, Map<List<Character>, Boolean> log) {
        this.delegate = delegate;
        this.log = log;
    }

    @Override
    public void processQueries(Collection<? extends Query<Character, Boolean>> queries) {
        delegate.processQueries(queries);
        for (Query<Character, Boolean> query : queries) {
            List<Character> input = query.getInput().asList();
    
            // Cast to DefaultQuery to access getOutput()
            if (query instanceof DefaultQuery) {
                Boolean output = ((DefaultQuery<Character, Boolean>) query).getOutput();
                log.putIfAbsent(input, output);
            } else {
                throw new IllegalStateException("Query is not an instance of DefaultQuery: " + query.getClass());
            }
        }
    }
}
